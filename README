```markdown
# ğŸŒŠ Physics-Guided Neural Forecasts of Nearshore Harmful Algal Blooms in the California Current System

## ğŸŒ² Overview  

This project develops a physics-guided deep learning framework for forecasting **harmful algal blooms (HABs)** along the California Current System. HABs, driven by climate variability and nutrient enrichment, threaten ecosystems, fisheries, and public health. Our models integrate **satellite ocean color, ocean reanalysis, and atmospheric predictors** to test whether adding **physical transport constraints** improves bloom prediction.

We compare three architectures:  
- **ConvLSTM** â€“ convolutional long short-term memory network  
- **TFT** â€“ Temporal Fusion Transformer  
- **PINN** â€“ physics-informed ConvLSTM enforcing 2D advectionâ€“diffusion dynamics  

The central question: *Do physics-guided neural networks improve coastal bloom forecast skill and spatial fidelity compared to purely statistical models?*  

---

## ğŸ“˜ Abstract  

Harmful algal blooms (HABs) are intensifying along the California coast, challenging forecasting systems that must resolve complex physicalâ€“biogeochemical interactions. We present a deep learning framework for **chlorophyll-a forecasting** using ConvLSTM, TFT, and a physics-informed ConvLSTM (PINN). The models are trained on an 18.6-year (2003â€“2021) nearshore dataset at 4 km resolution with engineered hydroclimatic and static predictors.  

**Key Findings:**  
* All models achieve ~0.80 RMSE and >0.77 correlation in log chlorophyll.  
* The PINN modestly improves spatial fidelity (relative scale error, spectral energy ratios) and convergence stability.  
* TFT lags in spatial generalization, showing stronger regional biases.  
* Case studies (Monterey Bay 2021, Navarro Lagoon 2020) show convolutionalâ€“recurrent models outperform transformers in reproducing bloom footprints.  
* Predictor attribution highlights **Kd490, river distance/influence, SST, and shortwave radiation** as dominant drivers.  

This hybrid framework balances statistical accuracy and physical interpretability, offering a scalable approach for operational coastal bloom forecasting.  

---

## ğŸ“ Repository Structure  

```

habs-forecast/
â”‚
â”œâ”€â”€ convLSTM/               # ConvLSTM model + diagnostics
â”‚   â”œâ”€â”€ baseline\_model.py
â”‚   â”œâ”€â”€ diagnostics.py
â”‚   â””â”€â”€ spatial\_bias.py
â”‚
â”œâ”€â”€ pinn/                   # Physics-informed ConvLSTM
â”‚   â”œâ”€â”€ pinn\_model.py
â”‚   â”œâ”€â”€ diagnostics.py
â”‚   â””â”€â”€ spatial\_bias.py
â”‚
â”œâ”€â”€ tft/                    # Temporal Fusion Transformer
â”‚   â”œâ”€â”€ tft\_model.py
â”‚   â”œâ”€â”€ diagnostics.py
â”‚   â””â”€â”€ spatial\_bias.py
â”‚
â”œâ”€â”€ Diagnostics\_ConvLSTM/   # Predicted fields + plots
â”œâ”€â”€ Diagnostics\_PINN/
â”œâ”€â”€ Diagnostics\_TFT/
â”‚
â”œâ”€â”€ monterey.py             # Case study: Monterey Bay HAB (2021)
â”œâ”€â”€ navarro.py              # Case study: Navarro Lagoon HAB (2020)
â”‚
â”œâ”€â”€ predictor\_importance\_pdp.py   # PDP + SHAP analyses
â”œâ”€â”€ extra\_diagnostics.py          # SHAP + feature importance plots
â”œâ”€â”€ mech\_figure.py                # PINN robustness tests
â”œâ”€â”€ lead\_skill\_summary.py         # Lead time forecast skill

```

---

## ğŸ§ª Experiments Overview  

| Model | Key Purpose |
|-------|-------------|
| **ConvLSTM** | Data-driven spatiotemporal benchmark |
| **TFT** | Attention-based probabilistic forecasting |
| **PINN** | Physics-informed ConvLSTM with advectionâ€“diffusion constraint |

---

## ğŸ“Š Evaluation Metrics  

* **RMSE, MAE, KGE** (continuous accuracy)  
* **Spearmanâ€™s Ï, Pearsonâ€™s r** (correlation structure)  
* **Bloom detection skill:** hit rate, false alarm ratio, F1, ROC-AUC, IoU  
* **Spatial fidelity:** relative scale error, spectral energy ratio, coastal RMSE profiles  
* **Physics diagnostics (PINN):** physics residuals, gradient norm ratios  
* **Predictor attribution:** SHAP values, PDPs, scatterplots  

---

## ğŸ“¡ Data Sources  

| Dataset | Variables | Relevance |
|---------|-----------|------------|
| **MODIS-Aqua (NASA Earthdata)** | Chlorophyll-a (ln), Kd490, nFLH, SST | Biomass proxy, optical/light drivers |
| **ERA5 (ECMWF)** | Wind (u, v, Ï„), radiation, precipitation, T2m, dewpoint | Meteorological forcing |
| **CMEMS GLORYS** | Currents, SSH, vorticity, salinity | Transport, circulation, retention |
| **Static features** | River distance, coastal mask, latitude | Nutrient influence, spatial context |

---

## ğŸ” Key Insights  

* **PINN improves realism:** modest gains in RMSE but stronger fidelity in bloom structure.  
* **ConvLSTM competitive:** achieves similar overall accuracy without physics, but less robust in structure.  
* **TFT underperforms:** struggles with sparse coastal grids.  
* **Drivers:** Kd490, river influence, SST, and radiation dominate predictor rankings.  
* **Skill ceiling:** ~0.80 RMSE in log chlorophyll; limited by coarse drivers (4 km, 8-day composites).  

---

## ğŸ’» Getting Started  

### ğŸ“¦ Dependencies  

Install required packages:  
```

pip install -r requirements.txt

```

Key libraries:  
* `tensorflow`, `keras`, `scikit-learn`, `xgboost`  
* `numpy`, `pandas`, `scipy`, `matplotlib`, `seaborn`  
* `xarray`, `rasterio`, `geopandas`, `cartopy`, `netCDF4`  

### â–¶ï¸ Running Models  

Activate environment and run:  
```

micromamba activate habs
cd \~/Desktop/habs-forecast
python convLSTM/baseline\_model.py
python pinn/pinn\_model.py
python tft/tft\_model.py

```

### ğŸ“ˆ Diagnostics and Plots  

```

python convLSTM/diagnostics.py
python pinn/spatial\_bias.py
python predictor\_importance\_pdp.py
python extra\_diagnostics.py
python mech\_figure.py
python lead\_skill\_summary.py
python monterey.py
python navarro.py

```

---

## ğŸ“‘ Paper and Citation  

If you use this work, please cite:  
> Mohanty, Y. (2025). *Physics-Guided Neural Forecasts of Nearshore Harmful Algal Blooms in the California Current System*. (In Review).  

---

## ğŸ§  Future Work  

* Higher-resolution inputs (hyperspectral ocean color, ROMS forecasts)  
* Ensemble probabilistic forecasting for longer leads (>2 weeks)  
* Multi-task learning for coupled biogeochemical variables (nitrate, DO)  
* Transferability tests in other upwelling systems (e.g., Humboldt, Benguela)  

---

## ğŸ“¬ Contact  

Questions or feedback? Reach out to:  

- ğŸ“§ yashnilmohanty@gmail.com  
- ğŸ”— GitHub: yashnil  

---

## ğŸ· License  

This project is licensed under the MIT License.  
```
