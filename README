```markdown
# 🌊 Physics-Guided Neural Forecasts of Nearshore Harmful Algal Blooms in the California Current System

## 🌲 Overview  

This project develops a physics-guided deep learning framework for forecasting **harmful algal blooms (HABs)** along the California Current System. HABs, driven by climate variability and nutrient enrichment, threaten ecosystems, fisheries, and public health. Our models integrate **satellite ocean color, ocean reanalysis, and atmospheric predictors** to test whether adding **physical transport constraints** improves bloom prediction.

We compare three architectures:  
- **ConvLSTM** – convolutional long short-term memory network  
- **TFT** – Temporal Fusion Transformer  
- **PINN** – physics-informed ConvLSTM enforcing 2D advection–diffusion dynamics  

The central question: *Do physics-guided neural networks improve coastal bloom forecast skill and spatial fidelity compared to purely statistical models?*  

---

## 📘 Abstract  

Harmful algal blooms (HABs) are intensifying along the California coast, challenging forecasting systems that must resolve complex physical–biogeochemical interactions. We present a deep learning framework for **chlorophyll-a forecasting** using ConvLSTM, TFT, and a physics-informed ConvLSTM (PINN). The models are trained on an 18.6-year (2003–2021) nearshore dataset at 4 km resolution with engineered hydroclimatic and static predictors.  

**Key Findings:**  
* All models achieve ~0.80 RMSE and >0.77 correlation in log chlorophyll.  
* The PINN modestly improves spatial fidelity (relative scale error, spectral energy ratios) and convergence stability.  
* TFT lags in spatial generalization, showing stronger regional biases.  
* Case studies (Monterey Bay 2021, Navarro Lagoon 2020) show convolutional–recurrent models outperform transformers in reproducing bloom footprints.  
* Predictor attribution highlights **Kd490, river distance/influence, SST, and shortwave radiation** as dominant drivers.  

This hybrid framework balances statistical accuracy and physical interpretability, offering a scalable approach for operational coastal bloom forecasting.  

---

## 📁 Repository Structure  

```

habs-forecast/
│
├── convLSTM/               # ConvLSTM model + diagnostics
│   ├── baseline\_model.py
│   ├── diagnostics.py
│   └── spatial\_bias.py
│
├── pinn/                   # Physics-informed ConvLSTM
│   ├── pinn\_model.py
│   ├── diagnostics.py
│   └── spatial\_bias.py
│
├── tft/                    # Temporal Fusion Transformer
│   ├── tft\_model.py
│   ├── diagnostics.py
│   └── spatial\_bias.py
│
├── Diagnostics\_ConvLSTM/   # Predicted fields + plots
├── Diagnostics\_PINN/
├── Diagnostics\_TFT/
│
├── monterey.py             # Case study: Monterey Bay HAB (2021)
├── navarro.py              # Case study: Navarro Lagoon HAB (2020)
│
├── predictor\_importance\_pdp.py   # PDP + SHAP analyses
├── extra\_diagnostics.py          # SHAP + feature importance plots
├── mech\_figure.py                # PINN robustness tests
├── lead\_skill\_summary.py         # Lead time forecast skill

```

---

## 🧪 Experiments Overview  

| Model | Key Purpose |
|-------|-------------|
| **ConvLSTM** | Data-driven spatiotemporal benchmark |
| **TFT** | Attention-based probabilistic forecasting |
| **PINN** | Physics-informed ConvLSTM with advection–diffusion constraint |

---

## 📊 Evaluation Metrics  

* **RMSE, MAE, KGE** (continuous accuracy)  
* **Spearman’s ρ, Pearson’s r** (correlation structure)  
* **Bloom detection skill:** hit rate, false alarm ratio, F1, ROC-AUC, IoU  
* **Spatial fidelity:** relative scale error, spectral energy ratio, coastal RMSE profiles  
* **Physics diagnostics (PINN):** physics residuals, gradient norm ratios  
* **Predictor attribution:** SHAP values, PDPs, scatterplots  

---

## 📡 Data Sources  

| Dataset | Variables | Relevance |
|---------|-----------|------------|
| **MODIS-Aqua (NASA Earthdata)** | Chlorophyll-a (ln), Kd490, nFLH, SST | Biomass proxy, optical/light drivers |
| **ERA5 (ECMWF)** | Wind (u, v, τ), radiation, precipitation, T2m, dewpoint | Meteorological forcing |
| **CMEMS GLORYS** | Currents, SSH, vorticity, salinity | Transport, circulation, retention |
| **Static features** | River distance, coastal mask, latitude | Nutrient influence, spatial context |

---

## 🔍 Key Insights  

* **PINN improves realism:** modest gains in RMSE but stronger fidelity in bloom structure.  
* **ConvLSTM competitive:** achieves similar overall accuracy without physics, but less robust in structure.  
* **TFT underperforms:** struggles with sparse coastal grids.  
* **Drivers:** Kd490, river influence, SST, and radiation dominate predictor rankings.  
* **Skill ceiling:** ~0.80 RMSE in log chlorophyll; limited by coarse drivers (4 km, 8-day composites).  

---

## 💻 Getting Started  

### 📦 Dependencies  

Install required packages:  
```

pip install -r requirements.txt

```

Key libraries:  
* `tensorflow`, `keras`, `scikit-learn`, `xgboost`  
* `numpy`, `pandas`, `scipy`, `matplotlib`, `seaborn`  
* `xarray`, `rasterio`, `geopandas`, `cartopy`, `netCDF4`  

### ▶️ Running Models  

Activate environment and run:  
```

micromamba activate habs
cd \~/Desktop/habs-forecast
python convLSTM/baseline\_model.py
python pinn/pinn\_model.py
python tft/tft\_model.py

```

### 📈 Diagnostics and Plots  

```

python convLSTM/diagnostics.py
python pinn/spatial\_bias.py
python predictor\_importance\_pdp.py
python extra\_diagnostics.py
python mech\_figure.py
python lead\_skill\_summary.py
python monterey.py
python navarro.py

```

---

## 📑 Paper and Citation  

If you use this work, please cite:  
> Mohanty, Y. (2025). *Physics-Guided Neural Forecasts of Nearshore Harmful Algal Blooms in the California Current System*. (In Review).  

---

## 🧠 Future Work  

* Higher-resolution inputs (hyperspectral ocean color, ROMS forecasts)  
* Ensemble probabilistic forecasting for longer leads (>2 weeks)  
* Multi-task learning for coupled biogeochemical variables (nitrate, DO)  
* Transferability tests in other upwelling systems (e.g., Humboldt, Benguela)  

---

## 📬 Contact  

Questions or feedback? Reach out to:  

- 📧 yashnilmohanty@gmail.com  
- 🔗 GitHub: yashnil  

---

## 🏷 License  

This project is licensed under the MIT License.  
```
